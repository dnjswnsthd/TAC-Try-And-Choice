<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.service.tac.model.mapper.CardCompareMapper">
	
	<resultMap type="Card" id="card">
		<id column="card_id" property="cardId" />
		<result column="card_name" property="cardName" />
		<result column="card_desc" property="cardDesc" />
		<result column="card_img" property="cardImg" />
	</resultMap>
	
	<resultMap type="cardDetail" id="cardDetailWithCategory">
		<id column="card_detail_id" property="cardDetailId" />
		<result column="discount_percent" property="discountPercent" />
		<result column="card_id" property="cardId" />
		<result column="large_category_id" property="largeCategoryId" />
		<result column="small_category_id" property="smallCategoryId" />
		<result column="min_payment" property="minPayment" />
		<result column="max_discount" property="maxDiscount" />
		<result column="max_count" property="mixCount" />
		<result column="discount_amount" property="discountAmount" />
		<result column="max_discount_month" property="maxDiscountMonth" />
		<association property="smallCategory" javaType="smallCategory">
			<id column="small_category_id" property="smallCategoryId" />
			<result column="small_category_name" property="smallCategoryName" />
			<result column="large_category_id" property="largeCategoryId" />
		</association>
		
	</resultMap>
	
	<resultMap type="cardDetail" id="cardBenefitByConsume">
		<id column="card_detail_id" property="cardDetailId" />
		<result column="discount_percent" property="discountPercent" />
		<result column="card_id" property="cardId" />
		<result column="large_category_id" property="largeCategoryId" />
		<result column="small_category_id" property="smallCategoryId" />
		<result column="min_payment" property="minPayment" />
		<result column="max_discount" property="maxDiscount" />
		<result column="max_count" property="mixCount" />
		<result column="discount_amount" property="discountAmount" />
		<result column="max_discount_month" property="maxDiscountMonth" />
		<association property="largeCategory" javaType="largeCategory">
			<id column="large_category_id" property="largeCategoryId" />
			<result column="large_category_name" property="largeCategoryName" />
		</association>
		<association property="consume" javaType="consume">
			<id column="consume_id" property="consumeId" />
			<result column="consume_price" property="consumePrice" />
			<result column="consume_date" property="consumeDate" />
			<result column="large_category_id" property="largeCategoryId" />
			<result column="small_category_id" property="smallCategoryId" />
		</association>
	</resultMap>
	
	<select id="getDiscountInfoByCard" parameterType="int" resultMap="cardDetailWithCategory">
		SELECT s.small_category_name, c.discount_percent, c.max_discount
		FROM  card_detail  c
		JOIN small_category  s
		ON (s.small_category_id = c.small_category_id)
		WHERE c.card_id=#{VALUE}
	</select>
	
	<select id="getCardInfo" parameterType="int" resultMap="card">
		SELECT card_id, card_name, card_desc, card_img  
		FROM card
		WHERE card_id=#{VALUE}
	</select>
	
	<select id="getBenefitsByCateg1" parameterType="int" resultMap="cardBenefitByConsume">
		SELECT c.consume_id, c.small_category_id, c.large_category_id, c.consume_price, c.consume_date, l.large_category_name, 
			   cd.card_id, cd.discount_percent, cd.discount_amount, cd.max_discount, cd.max_count, cd.min_payment, cd.max_discount_month
		FROM card_detail cd
		JOIN large_category l
		ON (cd.large_category_id  = l.large_category_id )
		JOIN consume c
		ON (cd.small_category_id = c.small_category_id)
		WHERE cd.card_id=#{param1} AND cd.large_category_id=1
		ORDER BY c.consume_date asc
	</select>
	
	<select id="getBenefitsByCateg2" parameterType="int" resultMap="cardBenefitByConsume">
		SELECT c.consume_id, c.small_category_id, c.large_category_id, c.consume_price, c.consume_date, l.large_category_name, 
			   cd.card_id, cd.discount_percent, cd.discount_amount, cd.max_discount, cd.max_count, cd.min_payment, cd.max_discount_month
		FROM card_detail cd
		JOIN large_category l
		ON (cd.large_category_id  = l.large_category_id )
		JOIN consume c
		ON (cd.small_category_id = c.small_category_id)
		WHERE cd.card_id=#{param1} AND cd.large_category_id=2
		ORDER BY c.consume_date asc
	</select>

	<select id="getBenefitsByCateg3" parameterType="int" resultMap="cardBenefitByConsume">
		SELECT c.consume_id, c.small_category_id, c.large_category_id, c.consume_price, c.consume_date, l.large_category_name, 
			   cd.card_id, cd.discount_percent, cd.discount_amount, cd.max_discount, cd.max_count, cd.min_payment, cd.max_discount_month
		FROM card_detail cd
		JOIN large_category l
		ON (cd.large_category_id  = l.large_category_id )
		JOIN consume c
		ON (cd.small_category_id = c.small_category_id)
		WHERE cd.card_id=#{param1} AND cd.large_category_id=3
		ORDER BY c.consume_date asc
	</select>
	
	<select id="getBenefitsByCateg4" parameterType="int" resultMap="cardBenefitByConsume">
		SELECT c.consume_id, c.small_category_id, c.large_category_id, c.consume_price, c.consume_date, l.large_category_name, 
			   cd.card_id, cd.discount_percent, cd.discount_amount, cd.max_discount, cd.max_count, cd.min_payment, cd.max_discount_month
		FROM card_detail cd
		JOIN large_category l
		ON (cd.large_category_id  = l.large_category_id )
		JOIN consume c
		ON (cd.small_category_id = c.small_category_id)
		WHERE cd.card_id=#{param1} AND cd.large_category_id=4
		ORDER BY c.consume_date asc
	</select>
	
	<select id="getBenefitsByCateg5" parameterType="int" resultMap="cardBenefitByConsume">
		SELECT c.consume_id, c.small_category_id, c.large_category_id, c.consume_price, c.consume_date, l.large_category_name, 
			   cd.card_id, cd.discount_percent, cd.discount_amount, cd.max_discount, cd.max_count, cd.min_payment, cd.max_discount_month
		FROM card_detail cd
		JOIN large_category l
		ON (cd.large_category_id  = l.large_category_id )
		JOIN consume c
		ON (cd.small_category_id = c.small_category_id)
		WHERE cd.card_id=#{param1} AND cd.large_category_id=5
		ORDER BY c.consume_date asc
	</select>
	
	<select id="getBenefitsByCateg6" parameterType="int" resultMap="cardBenefitByConsume">
		SELECT c.consume_id, c.small_category_id, c.large_category_id, c.consume_price, c.consume_date, l.large_category_name, 
			   cd.card_id, cd.discount_percent, cd.discount_amount, cd.max_discount, cd.max_count, cd.min_payment, cd.max_discount_month
		FROM card_detail cd
		JOIN large_category l
		ON (cd.large_category_id  = l.large_category_id )
		JOIN consume c
		ON (cd.small_category_id = c.small_category_id)
		WHERE cd.card_id=#{param1} AND cd.large_category_id=6
		ORDER BY c.consume_date asc
	</select>

	<select id="getBenefitsByCateg7" parameterType="int" resultMap="cardBenefitByConsume">
		SELECT c.consume_id, c.small_category_id, c.large_category_id, c.consume_price, c.consume_date, l.large_category_name, 
			   cd.card_id, cd.discount_percent, cd.discount_amount, cd.max_discount, cd.max_count, cd.min_payment, cd.max_discount_month
		FROM card_detail cd
		JOIN large_category l
		ON (cd.large_category_id  = l.large_category_id )
		JOIN consume c
		ON (cd.small_category_id = c.small_category_id)
		WHERE cd.card_id=#{param1} AND cd.large_category_id=7
		ORDER BY c.consume_date asc
	</select>
	
	<select id="getBenefitsByCateg8" parameterType="int" resultMap="cardBenefitByConsume">
		SELECT c.consume_id, c.small_category_id, c.large_category_id, c.consume_price, c.consume_date, l.large_category_name, 
			   cd.card_id, cd.discount_percent, cd.discount_amount, cd.max_discount, cd.max_count, cd.min_payment, cd.max_discount_month
		FROM card_detail cd
		JOIN large_category l
		ON (cd.large_category_id  = l.large_category_id )
		JOIN consume c
		ON (cd.small_category_id = c.small_category_id)
		WHERE cd.card_id=#{param1} AND cd.large_category_id=8
		ORDER BY c.consume_date asc
	</select>
	
	<select id="getBenefitsByCateg9" parameterType="int" resultMap="cardBenefitByConsume">
		SELECT c.consume_id, c.small_category_id, c.large_category_id, c.consume_price, c.consume_date, l.large_category_name, 
			   cd.card_id, cd.discount_percent, cd.discount_amount, cd.max_discount, cd.max_count, cd.min_payment, cd.max_discount_month
		FROM card_detail cd
		JOIN large_category l
		ON (cd.large_category_id  = l.large_category_id )
		JOIN consume c
		ON (cd.small_category_id = c.small_category_id)
		WHERE cd.card_id=#{param1} AND cd.large_category_id=9
		ORDER BY c.consume_date asc
	</select>
	
	<select id="getBenefitsByCateg10" parameterType="int" resultMap="cardBenefitByConsume">
		SELECT c.consume_id, c.small_category_id, c.large_category_id, c.consume_price, c.consume_date, l.large_category_name, 
			   cd.card_id, cd.discount_percent, cd.discount_amount, cd.max_discount, cd.max_count, cd.min_payment, cd.max_discount_month
		FROM card_detail cd
		JOIN large_category l
		ON (cd.large_category_id  = l.large_category_id )
		JOIN consume c
		ON (cd.small_category_id = c.small_category_id)
		WHERE cd.card_id=#{param1} AND cd.large_category_id=10
		ORDER BY c.consume_date asc
	</select>
	
	<select id="getBenefitsByCateg11" parameterType="int" resultMap="cardBenefitByConsume">
		SELECT c.consume_id, c.small_category_id, c.large_category_id, c.consume_price, c.consume_date, l.large_category_name, 
			   cd.card_id, cd.discount_percent, cd.discount_amount, cd.max_discount, cd.max_count, cd.min_payment, cd.max_discount_month
		FROM card_detail cd
		JOIN large_category l
		ON (cd.large_category_id  = l.large_category_id )
		JOIN consume c
		ON (cd.small_category_id = c.small_category_id)
		WHERE cd.card_id=#{param1} AND cd.large_category_id=11
		ORDER BY c.consume_date asc
	</select>
	
	<select id="getBenefitsByCateg12" parameterType="int" resultMap="cardBenefitByConsume">
		SELECT c.consume_id, c.small_category_id, c.large_category_id, c.consume_price, c.consume_date, l.large_category_name, 
			   cd.card_id, cd.discount_percent, cd.discount_amount, cd.max_discount, cd.max_count, cd.min_payment, cd.max_discount_month
		FROM card_detail cd
		JOIN large_category l
		ON (cd.large_category_id  = l.large_category_id )
		JOIN consume c
		ON (cd.small_category_id = c.small_category_id)
		WHERE cd.card_id=#{param1} AND cd.large_category_id=12
		ORDER BY c.consume_date asc
	</select>
	
	<select id="getBenefitsByCateg13" parameterType="int" resultMap="cardBenefitByConsume">
		SELECT c.consume_id, c.small_category_id, c.large_category_id, c.consume_price, c.consume_date, l.large_category_name, 
			   cd.card_id, cd.discount_percent, cd.discount_amount, cd.max_discount, cd.max_count, cd.min_payment, cd.max_discount_month
		FROM card_detail cd
		JOIN large_category l
		ON (cd.large_category_id  = l.large_category_id )
		JOIN consume c
		ON (cd.small_category_id = c.small_category_id)
		WHERE cd.card_id=#{param1} AND cd.large_category_id=13
		ORDER BY c.consume_date asc
	</select>
	
	<select id="getBenefitsByCateg14" parameterType="int" resultMap="cardBenefitByConsume">
		SELECT c.consume_id, c.small_category_id, c.large_category_id, c.consume_price, c.consume_date, l.large_category_name, 
			   cd.card_id, cd.discount_percent, cd.discount_amount, cd.max_discount, cd.max_count, cd.min_payment, cd.max_discount_month
		FROM card_detail cd
		JOIN large_category l
		ON (cd.large_category_id  = l.large_category_id )
		JOIN consume c
		ON (cd.small_category_id = c.small_category_id)
		WHERE cd.card_id=#{param1} AND cd.large_category_id=14
		ORDER BY c.consume_date asc
	</select>
	
	<select id="getBenefitsByCateg15" parameterType="int" resultMap="cardBenefitByConsume">
		SELECT c.consume_id, c.small_category_id, c.large_category_id, c.consume_price, c.consume_date, l.large_category_name, 
			   cd.card_id, cd.discount_percent, cd.discount_amount, cd.max_discount, cd.max_count, cd.min_payment, cd.max_discount_month
		FROM card_detail cd
		JOIN large_category l
		ON (cd.large_category_id  = l.large_category_id )
		JOIN consume c
		ON (cd.small_category_id = c.small_category_id)
		WHERE cd.card_id=#{param1} AND cd.large_category_id=15
		ORDER BY c.consume_date asc
	</select>
	
	<select id="getBenefitsByCateg16" parameterType="int" resultMap="cardBenefitByConsume">
		SELECT c.consume_id, c.small_category_id, c.large_category_id, c.consume_price, c.consume_date, l.large_category_name, 
			   cd.card_id, cd.discount_percent, cd.discount_amount, cd.max_discount, cd.max_count, cd.min_payment, cd.max_discount_month
		FROM card_detail cd
		JOIN large_category l
		ON (cd.large_category_id  = l.large_category_id )
		JOIN consume c
		ON (cd.small_category_id = c.small_category_id)
		WHERE cd.card_id=#{param1} AND cd.large_category_id=16
		ORDER BY c.consume_date asc
	</select>
	
	<select id="getBenefitsByCateg17" parameterType="int" resultMap="cardBenefitByConsume">
		SELECT c.consume_id, c.small_category_id, c.large_category_id, c.consume_price, c.consume_date, l.large_category_name, 
			   cd.card_id, cd.discount_percent, cd.discount_amount, cd.max_discount, cd.max_count, cd.min_payment, cd.max_discount_month
		FROM card_detail cd
		JOIN large_category l
		ON (cd.large_category_id  = l.large_category_id )
		JOIN consume c
		ON (cd.small_category_id = c.small_category_id)
		WHERE cd.card_id=#{param1} AND cd.large_category_id=17
		ORDER BY c.consume_date asc
	</select>
	
	<select id="getBenefitsByCateg18" parameterType="int" resultMap="cardBenefitByConsume">
		SELECT c.consume_id, c.small_category_id, c.large_category_id, c.consume_price, c.consume_date, l.large_category_name, 
			   cd.card_id, cd.discount_percent, cd.discount_amount, cd.max_discount, cd.max_count, cd.min_payment, cd.max_discount_month
		FROM card_detail cd
		JOIN large_category l
		ON (cd.large_category_id  = l.large_category_id )
		JOIN consume c
		ON (cd.small_category_id = c.small_category_id)
		WHERE cd.card_id=#{param1} AND cd.large_category_id=18
		ORDER BY c.consume_date asc
	</select>
	
	<select id="getBenefitsByCateg19" parameterType="int" resultMap="cardBenefitByConsume">
		SELECT c.consume_id, c.small_category_id, c.large_category_id, c.consume_price, c.consume_date, l.large_category_name, 
			   cd.card_id, cd.discount_percent, cd.discount_amount, cd.max_discount, cd.max_count, cd.min_payment, cd.max_discount_month
		FROM card_detail cd
		JOIN large_category l
		ON (cd.large_category_id  = l.large_category_id )
		JOIN consume c
		ON (cd.small_category_id = c.small_category_id)
		WHERE cd.card_id=#{param1} AND cd.large_category_id=19
		ORDER BY c.consume_date asc
	</select>
	
	<select id="getBenefitsByCateg20" parameterType="int" resultMap="cardBenefitByConsume">
		SELECT c.consume_id, c.small_category_id, c.large_category_id, c.consume_price, c.consume_date, l.large_category_name, 
			   cd.card_id, cd.discount_percent, cd.discount_amount, cd.max_discount, cd.max_count, cd.min_payment, cd.max_discount_month
		FROM card_detail cd
		JOIN large_category l
		ON (cd.large_category_id  = l.large_category_id )
		JOIN consume c
		ON (cd.small_category_id = c.small_category_id)
		WHERE cd.card_id=#{param1} AND cd.large_category_id=20
		ORDER BY c.consume_date asc
	</select>
	
	<select id="getBenefitsByCateg21" parameterType="int" resultMap="cardBenefitByConsume">
		SELECT c.consume_id, c.small_category_id, c.large_category_id, c.consume_price, c.consume_date, l.large_category_name, 
			   cd.card_id, cd.discount_percent, cd.discount_amount, cd.max_discount, cd.max_count, cd.min_payment, cd.max_discount_month
		FROM card_detail cd
		JOIN large_category l
		ON (cd.large_category_id  = l.large_category_id )
		JOIN consume c
		ON (cd.small_category_id = c.small_category_id)
		WHERE cd.card_id=#{param1} AND cd.large_category_id=21
		ORDER BY c.consume_date asc
	</select>
	
	<select id="getBenefitsByCateg22" parameterType="int" resultMap="cardBenefitByConsume">
		SELECT c.consume_id, c.small_category_id, c.large_category_id, c.consume_price, c.consume_date, l.large_category_name, 
			   cd.card_id, cd.discount_percent, cd.discount_amount, cd.max_discount, cd.max_count, cd.min_payment, cd.max_discount_month
		FROM card_detail cd
		JOIN large_category l
		ON (cd.large_category_id  = l.large_category_id )
		JOIN consume c
		ON (cd.small_category_id = c.small_category_id)
		WHERE cd.card_id=#{param1} AND cd.large_category_id=22
		ORDER BY c.consume_date asc
	</select>
</mapper>
